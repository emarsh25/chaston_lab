plot_2016S
file_path <- "iPLA"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
flies_unweighted <- read.table(url(paste(urlfile,'core-metrics-results-',file_path,'/unweighted_unifrac_distance_matrix/distance-matrix.tsv',sep="")), header=T, sep="\t") %>% mutate(X=as.character(X))
flies_unweighted_dm <- as.dist(flies_unweighted[,2:dim(flies_unweighted)[2]])
map_file <- read.table(url(mapper_url),comment.char = "", header=T, fill=T, sep="\t") %>% mutate(X.SampleID = gsub(pattern = "-",replacement = "-",x = X.SampleID))
flies_unifrac_table <- flies_unweighted %>% dplyr::select(X) %>% left_join(map_file, by=c("X"="X.SampleID")) %>% droplevels()
fig1_Suw_permanova <- adonis2(flies_unweighted_dm ~ lab * genotype_class * vial_model, flies_unifrac_table, permutations=1000)
fig1_permSU <- tableGrob(round(fig1_Suw_permanova, 2), theme=ttheme_minimal())
plot(fig1_permSU)
file_path <- "iPLA"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
flies_weighted <- read.table(url(paste(urlfile,'core-metrics-results-',file_path,'/weighted_unifrac_distance_matrix/distance-matrix.tsv',sep="")), header=T, sep="\t")
flies_weighted_dm <- as.dist(flies_weighted[,2:dim(flies_weighted)[2]])
map_file <- read.table(url(mapper_url),comment.char = "", header=T, fill=T, sep="\t") %>% mutate(X.SampleID = gsub(pattern = "-",replacement = "-",x = X.SampleID))
flies_unifrac_table <- flies_weighted %>% dplyr::select(X) %>% left_join(map_file, by=c("X"="X.SampleID")) %>% droplevels()
fig1_Sw_permanova <- adonis2(flies_weighted_dm ~ lab * genotype_class * vial_model, flies_unifrac_table, permutations = 1000)
fig1_permSW <- tableGrob(round(fig1_Sw_permanova, 2), theme=ttheme_minimal())
plot(fig1_permSW)
file_path <- "iPLA"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
flies_bc <- read.table(url(paste(urlfile,'core-metrics-results-',file_path,'/bray_curtis_distance_matrix/distance-matrix.tsv',sep="")), header=T, sep="\t")
flies_bc_dm <- as.dist(flies_bc[,2:dim(flies_bc)[2]])
map_file <- read.table(url(mapper_url),comment.char = "", header=T, fill=T, sep="\t") %>% mutate(X.SampleID = gsub(pattern = "-",replacement = "-",x = X.SampleID))
flies_unifrac_table <- flies_bc %>% dplyr::select(X) %>% left_join(map_file, by=c("X"="X.SampleID")) %>% droplevels()
fig1_Sb_permanova <- adonis2(flies_bc_dm ~ lab * genotype_class * vial_model, flies_unifrac_table, permutations = 1000)
fig1_permSB <- tableGrob(round(fig1_Sb_permanova, 2), theme=ttheme_minimal())
plot(fig1_permSB)
file_path <- "Bellen"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/Bellen/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
map_file <- read.table(url(mapper_url),comment.char = "", header=T, fill=T, sep="\t") %>% mutate(X.SampleID = gsub(pattern = "-",replacement = "-",x = X.SampleID))
shannon_file <- read.table(url(paste(urlfile,'core-metrics-results-',file_path,'/shannon_richness/alpha-diversity.tsv',sep="")), header=T, sep="\t") %>% mutate(X=as.character(X))
shannon_table <- shannon_file %>% left_join(map_file, by=c("X"="X.SampleID"))
alpha <- shannon_table %>% group_by(genotype) %>% summarise(X, richness = mean(shannon_entropy)) %>% ungroup()
shannon_table <- shannon_table %>% left_join(alpha, "X" = "X")
shannon_table <- dplyr::select(shannon_table,X, genotype, genotype_class, richness, shannon_entropy)
wilcox <- wilcox.test(shannon_table$shannon_entropy~shannon_table$genotype_class)
shannon_table <- shannon_table %>% group_by(genotype) %>% summarise(X, genotype, genotype_class, richness, shannon_entropy, SEM = (sd(shannon_entropy) / sqrt(length(shannon_entropy)))) %>% ungroup()
shannon_table <- dplyr::select(shannon_table, genotype, genotype_class, richness, SEM) %>% unique()
shannon_plot <- ggplot(shannon_table, aes(x=genotype, y=richness)) +
geom_bar(position=position_dodge(), stat="identity") +
geom_errorbar(aes(ymin=richness+SEM, ymax=richness-SEM),
width=.2,# Width of the error bars
position=position_dodge(.9)) +
coord_cartesian(ylim=c((min(shannon_table$richness-shannon_table$SEM)*.5),max(shannon_table$richness+shannon_table$SEM)*1.15)) +
scale_x_discrete(breaks=c("iPLA2-VIA Control", "iPLA2-VIA[Delta174]", "iPLA2-VIA[Delta192]"), labels=c("iPLA2-VIA (Control)", "iPLA2-VIA[Delta174] (Mutant)", "iPLA2-VIA[Delta192] (Mutant)")) +
theme_cowplot() +
theme(axis.text=element_text(size=14),
panel.background = element_blank(),
axis.line = element_line(),
axis.ticks=element_line(),
axis.title=element_text(size=16),
title=element_text(size=20),
legend.position = "none") +
labs(y="Richness",x=str_to_title("genotype"),title= paste0("Shannon Richness (p-value: ", toString(round(wilcox$p.value, 3)), ")"))
shannon_plot
file_path <- "iPLA"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
folder_name = paste0(file_path, "/unweighted_unifrac")
var1 = "genotype_class"
var1_colors <-c("blue","red")
title_name_add <- "unweighted Unifrac"
legend_position = "bottom"
labs = c("Mutant", "Control")
plot_uw2016 <- pcoa_1var(urlpath = urlfile, folder_name=folder_name, mapper_file = mapper_url, var1=var1, var1_colors=var1_colors, title_name_add=title_name_add, legend_position = legend_position)
plot_uw2016 <- plot_uw2016 + scale_color_manual(name="Genotype", labels=labs, values=var1_colors) +
scale_fill_manual(name="Genotype", labels=labs, values=var1_colors)
plot_uw2016
file_path <- "iPLA"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
folder_name = paste0(file_path, "/weighted_unifrac")
var1 = "genotype_class"
var1_colors <-c("blue","red")
title_name_add <- "weighted Unifrac"
legend_position = "bottom"
labs = c("Mutant", "Control")
plot_w2016 <- pcoa_1var(urlpath = urlfile, folder_name=folder_name, mapper_file = mapper_url, var1=var1, var1_colors=var1_colors, title_name_add=title_name_add, legend_position = legend_position)
plot_w2016 <- plot_w2016 + scale_color_manual(name="Genotype", labels=labs, values=var1_colors) +
scale_fill_manual(name="Genotype", labels=labs, values=var1_colors)
plot_w2016
file_path <- "iPLA"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
folder_name = paste0(file_path, "/bray_curtis")
var1 = "genotype_class"
var1_colors <-c("blue","red")
title_name_add <- "Bray Curtis"
legend_position = "bottom"
labs = c("Mutant", "Control")
plot_bc2016 <- pcoa_1var(urlpath = urlfile,folder_name=folder_name, mapper_file = mapper_url, var1=var1, var1_colors=var1_colors,title_name_add=title_name_add, legend_position = legend_position)
plot_bc2016 <- plot_bc2016 + scale_color_manual(name="Genotype Class", labels=labs, values=var1_colors) +
scale_fill_manual(name="Genotype", labels=labs, values=var1_colors)
plot_bc2016
file_path <- "iPLA"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
folder_name = paste0(file_path, "/weighted_unifrac")
var1 = "genotype_class"
var1_colors <-c("blue","red")
title_name_add <- "weighted Unifrac"
legend_position = "bottom"
labs = c("Mutant", "Control")
plot_w2016 <- pcoa_1var(urlpath = urlfile, folder_name=folder_name, mapper_file = mapper_url, var1=var1, var1_colors=var1_colors, title_name_add=title_name_add, legend_position = legend_position)
plot_w2016 <- plot_w2016 + scale_color_manual(name="Genotype Class", labels=labs, values=var1_colors) +
scale_fill_manual(name="Genotype Class", labels=labs, values=var1_colors)
plot_w2016
file_path <- "iPLA"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
folder_name = paste0(file_path, "/bray_curtis")
var1 = "genotype_class"
var1_colors <-c("blue","red")
title_name_add <- "Bray Curtis"
legend_position = "bottom"
labs = c("Mutant", "Control")
plot_bc2016 <- pcoa_1var(urlpath = urlfile,folder_name=folder_name, mapper_file = mapper_url, var1=var1, var1_colors=var1_colors,title_name_add=title_name_add, legend_position = legend_position)
plot_bc2016 <- plot_bc2016 + scale_color_manual(name="Genotype Class", labels=labs, values=var1_colors) +
scale_fill_manual(name="Genotype Class", labels=labs, values=var1_colors)
plot_bc2016
file_path <- "iPLA"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
var1 = "genotype"
var2 = "genotype"
var3 = "genotype"
the_id = "X.SampleID"
newcol <- "newcol"
main.var="genotype"
adj.formula= "genotype"
map_path = "-call19"
random.formula = NULL #"~1|vial_num"
multcorr="BH"
sig=0.05
prev.cut=0.9
Group = "genotype"
taxonomic_level = "genus"
ancom_colors = c("green")
breaks = c("iPLA2-VIA Control", "iPLA2-VIA[Delta174]", "iPLA2-VIA[Delta192]")
labs = c("iPLA2-VIA (Control)", "iPLA2-VIA[Delta174] (Mutant)", "iPLA2-VIA[Delta192] (Mutant)")
make_ancom2_plots(urlpath = urlfile, file_path, map_path=map_path, mapper_file=url(mapper_url), taxonomic_level=taxonomic_level,var1=var1,var2=var2,var3=var3,newcol="newcol", the_id = "X.SampleID", main.var=main.var, adj.formula=adj.formula, random.formula = random.formula, repeat.var = repeat.var, multcorr=multcorr, sig=sig, prev.cut=prev.cut, Group = Group, color = ancom_colors, breaks = breaks, labs = labs)
library(parkFlies)
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
flies_unweighted <- read.table(url(paste(urlfile,'core-metrics-results-',file_path,'/unweighted_unifrac_distance_matrix/distance-matrix.tsv',sep="")), header=T, sep="\t") %>% mutate(X=as.character(X))
flies_unweighted_dm <- as.dist(flies_unweighted[,2:dim(flies_unweighted)[2]])
map_file <- read.table(url(mapper_url),comment.char = "", header=T, fill=T, sep="\t") %>% mutate(X.SampleID = gsub(pattern = "-",replacement = "-",x = X.SampleID))
flies_unifrac_table <- flies_unweighted %>% dplyr::select(X) %>% left_join(map_file, by=c("X"="X.SampleID")) %>% droplevels()
fig1_Suw_permanova <- adonis2(flies_unweighted_dm ~ lab * genotype * vial_model, flies_unifrac_table, permutations=1000)
fig1_permSU <- tableGrob(round(fig1_Suw_permanova, 2), theme=ttheme_minimal())
plot(fig1_permSU)
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
flies_weighted <- read.table(url(paste(urlfile,'core-metrics-results-',file_path,'/weighted_unifrac_distance_matrix/distance-matrix.tsv',sep="")), header=T, sep="\t")
flies_weighted_dm <- as.dist(flies_weighted[,2:dim(flies_weighted)[2]])
map_file <- read.table(url(mapper_url),comment.char = "", header=T, fill=T, sep="\t") %>% mutate(X.SampleID = gsub(pattern = "-",replacement = "-",x = X.SampleID))
flies_unifrac_table <- flies_weighted %>% dplyr::select(X) %>% left_join(map_file, by=c("X"="X.SampleID")) %>% droplevels()
fig1_Sw_permanova <- adonis2(flies_weighted_dm ~ lab * genotype * vial_model, flies_unifrac_table, permutations = 1000)
fig1_permSW <- tableGrob(round(fig1_Sw_permanova, 2), theme=ttheme_minimal())
plot(fig1_permSW)
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
flies_bc <- read.table(url(paste(urlfile,'core-metrics-results-',file_path,'/bray_curtis_distance_matrix/distance-matrix.tsv',sep="")), header=T, sep="\t")
flies_bc_dm <- as.dist(flies_bc[,2:dim(flies_bc)[2]])
map_file <- read.table(url(mapper_url),comment.char = "", header=T, fill=T, sep="\t") %>% mutate(X.SampleID = gsub(pattern = "-",replacement = "-",x = X.SampleID))
flies_unifrac_table <- flies_bc %>% dplyr::select(X) %>% left_join(map_file, by=c("X"="X.SampleID")) %>% droplevels()
fig1_Sb_permanova <- adonis2(flies_bc_dm ~ lab * genotype_class * vial_model, flies_unifrac_table, permutations = 1000)
fig1_permSB <- tableGrob(round(fig1_Sb_permanova, 2), theme=ttheme_minimal())
plot(fig1_permSB)
file_path <- "iPLA"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
map_file <- read.table(url(mapper_url),comment.char = "", header=T, fill=T, sep="\t") %>% mutate(X.SampleID = gsub(pattern = "-",replacement = "-",x = X.SampleID))
shannon_file <- read.table(url(paste(urlfile,'core-metrics-results-',file_path,'/shannon_richness/alpha-diversity.tsv',sep="")), header=T, sep="\t") %>% mutate(X=as.character(X))
shannon_table <- shannon_file %>% left_join(map_file, by=c("X"="X.SampleID"))
alpha <- shannon_table %>% group_by(lab) %>% summarise(X, richness = mean(shannon_entropy)) %>% ungroup()
shannon_table <- shannon_table %>% left_join(alpha, "X" = "X")
shannon_table <- dplyr::select(shannon_table,X, lab, richness, shannon_entropy)
wilcox <- wilcox.test(shannon_table$shannon_entropy~shannon_table$lab)
shannon_table <- shannon_table %>% group_by(lab) %>% summarise(X, lab, richness, shannon_entropy, SEM = (sd(shannon_entropy) / sqrt(length(shannon_entropy)))) %>% ungroup()
shannon_table <- dplyr::select(shannon_table, lab, richness, SEM) %>% unique()
shannon_plot <- ggplot(shannon_table, aes(x=lab, y=richness)) +
geom_bar(position=position_dodge(), stat="identity") +
geom_errorbar(aes(ymin=richness+SEM, ymax=richness-SEM),
width=.2, # Width of the error bars
position=position_dodge(.9)) +
coord_cartesian(ylim=c((min(shannon_table$richness-shannon_table$SEM)*.5),max(shannon_table$richness+shannon_table$SEM)*1.15))  +
theme_cowplot() +
theme(axis.text=element_text(size=14),
panel.background = element_blank(),
axis.line = element_line(),
axis.ticks=element_line(),
axis.title=element_text(size=16),
title=element_text(size=20),
legend.position = "none") +
labs(y="Richness",x=str_to_title("lab"),title= paste0("Shannon Richness (p-value: ", toString(round(wilcox$p.value, 3)), ")"))
shannon_plot
file_path <- "iPLA"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
map_file <- read.table(url(mapper_url),comment.char = "", header=T, fill=T, sep="\t") %>% mutate(X.SampleID = gsub(pattern = "-",replacement = "-",x = X.SampleID))
shannon_file <- read.table(url(paste(urlfile,'core-metrics-results-',file_path,'/shannon_richness/alpha-diversity.tsv',sep="")), header=T, sep="\t") %>% mutate(X=as.character(X))
shannon_table <- shannon_file %>% left_join(map_file, by=c("X"="X.SampleID"))
alpha <- shannon_table %>% group_by(lab) %>% summarise(X, richness = mean(shannon_entropy)) %>% ungroup()
shannon_table <- shannon_table %>% left_join(alpha, "X" = "X")
shannon_table <- dplyr::select(shannon_table,X, lab, richness, shannon_entropy)
wilcox <- wilcox.test(shannon_table$shannon_entropy~shannon_table$lab)
shannon_table <- shannon_table %>% group_by(lab) %>% summarise(X, lab, richness, shannon_entropy, SEM = (sd(shannon_entropy) / sqrt(length(shannon_entropy)))) %>% ungroup()
shannon_table <- dplyr::select(shannon_table, lab, richness, SEM) %>% unique()
shannon_plot <- ggplot(shannon_table, aes(x=lab, y=richness)) +
geom_bar(position=position_dodge(), stat="identity") +
geom_errorbar(aes(ymin=richness+SEM, ymax=richness-SEM),
width=.2, # Width of the error bars
position=position_dodge(.9)) +
coord_cartesian(ylim=c((min(shannon_table$richness-shannon_table$SEM)*.5),max(shannon_table$richness+shannon_table$SEM)*1.15))  +
theme_cowplot() +
theme(axis.text=element_text(size=14),
panel.background = element_blank(),
axis.line = element_line(),
axis.ticks=element_line(),
axis.title=element_text(size=16),
title=element_text(size=20),
legend.position = "none") +
labs(y="Richness",x=str_to_title("lab"),title= paste0("Shannon Richness (p-value: ", toString(round(wilcox$p.value, 3)), ")"))
shannon_plot
file_path <- "iPLA"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
map_file <- read.table(url(mapper_url),comment.char = "", header=T, fill=T, sep="\t") %>% mutate(X.SampleID = gsub(pattern = "-",replacement = "-",x = X.SampleID))
ace_file <- read.table(paste('core-metrics-results-',file_path,'/ace_richness/alpha-diversity.tsv',sep=""), header=T, sep="\t") %>% mutate(X=as.character(X))
ace_table <- ace_file %>% left_join(map_file, by=c("X"="X.SampleID"))
alpha <- ace_table %>% group_by(lab) %>% summarise(X, richness = mean(ace)) %>% ungroup()
ace_table <- ace_table %>% left_join(alpha, "X" = "X")
ace_table <- dplyr::select(ace_table,X, lab, richness, ace)
wilcox <- wilcox.test(ace_table$ace~ace_table$lab)
ace_table <- ace_table %>% group_by(lab) %>% summarise(X, lab, richness, ace, SEM = (sd(ace) / sqrt(length(ace)))) %>% ungroup()
ace_table <- dplyr::select(ace_table, lab, richness, SEM) %>% unique()
ace_plot <- ggplot(ace_table, aes(x=lab, y=richness)) +
geom_bar(position=position_dodge(), stat="identity") +
geom_errorbar(aes(ymin=richness+SEM, ymax=richness-SEM),
width=.2, # Width of the error bars
position=position_dodge(.9)) +
coord_cartesian(ylim=c((min(ace_table$richness-ace_table$SEM)*.5),max(ace_table$richness+ace_table$SEM)*1.15)) +
theme_cowplot() +
theme(axis.text=element_text(size=14),
panel.background = element_blank(),
axis.line = element_line(),
axis.ticks=element_line(),
axis.title=element_text(size=16),
title=element_text(size=20),
legend.position = "none") +
labs(y="Richness",x=str_to_title("lab"),title= paste0("Ace Richness (p-value: ", toString(round(wilcox$p.value, 3)), ")"))
ace_plot
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
map_file <- read.table(url(mapper_url),comment.char = "", header=T, fill=T, sep="\t") %>% mutate(X.SampleID = gsub(pattern = "-",replacement = "-",x = X.SampleID))
shannon_file <- read.table(url(paste(urlfile,'core-metrics-results-',file_path,'/shannon_richness/alpha-diversity.tsv',sep="")), header=T, sep="\t") %>% mutate(X=as.character(X))
shannon_table <- shannon_file %>% left_join(map_file, by=c("X"="X.SampleID"))
alpha <- shannon_table %>% group_by(lab) %>% summarise(X, richness = mean(shannon_entropy)) %>% ungroup()
shannon_table <- shannon_table %>% left_join(alpha, "X" = "X")
shannon_table <- dplyr::select(shannon_table,X, lab, richness, shannon_entropy)
wilcox <- wilcox.test(shannon_table$shannon_entropy~shannon_table$lab)
shannon_table <- shannon_table %>% group_by(lab) %>% summarise(X, lab, richness, shannon_entropy, SEM = (sd(shannon_entropy) / sqrt(length(shannon_entropy)))) %>% ungroup()
shannon_table <- dplyr::select(shannon_table, lab, richness, SEM) %>% unique()
shannon_plot <- ggplot(shannon_table, aes(x=lab, y=richness)) +
geom_bar(position=position_dodge(), stat="identity") +
geom_errorbar(aes(ymin=richness+SEM, ymax=richness-SEM),
width=.2, # Width of the error bars
position=position_dodge(.9)) +
coord_cartesian(ylim=c((min(shannon_table$richness-shannon_table$SEM)*.5),max(shannon_table$richness+shannon_table$SEM)*1.15))  +
theme_cowplot() +
theme(axis.text=element_text(size=14),
panel.background = element_blank(),
axis.line = element_line(),
axis.ticks=element_line(),
axis.title=element_text(size=16),
title=element_text(size=20),
legend.position = "none") +
labs(y="Richness",x=str_to_title("lab"),title= paste0("Shannon Richness (p-value: ", toString(round(wilcox$p.value, 3)), ")"))
shannon_plot
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
map_file <- read.table(url(mapper_url),comment.char = "", header=T, fill=T, sep="\t") %>% mutate(X.SampleID = gsub(pattern = "-",replacement = "-",x = X.SampleID))
ace_file <- read.table(paste('core-metrics-results-',file_path,'/ace_richness/alpha-diversity.tsv',sep=""), header=T, sep="\t") %>% mutate(X=as.character(X))
ace_table <- ace_file %>% left_join(map_file, by=c("X"="X.SampleID"))
alpha <- ace_table %>% group_by(lab) %>% summarise(X, richness = mean(ace)) %>% ungroup()
ace_table <- ace_table %>% left_join(alpha, "X" = "X")
ace_table <- dplyr::select(ace_table,X, lab, richness, ace)
wilcox <- wilcox.test(ace_table$ace~ace_table$lab)
ace_table <- ace_table %>% group_by(lab) %>% summarise(X, lab, richness, ace, SEM = (sd(ace) / sqrt(length(ace)))) %>% ungroup()
ace_table <- dplyr::select(ace_table, lab, richness, SEM) %>% unique()
ace_plot <- ggplot(ace_table, aes(x=lab, y=richness)) +
geom_bar(position=position_dodge(), stat="identity") +
geom_errorbar(aes(ymin=richness+SEM, ymax=richness-SEM),
width=.2, # Width of the error bars
position=position_dodge(.9)) +
coord_cartesian(ylim=c((min(ace_table$richness-ace_table$SEM)*.5),max(ace_table$richness+ace_table$SEM)*1.15)) +
theme_cowplot() +
theme(axis.text=element_text(size=14),
panel.background = element_blank(),
axis.line = element_line(),
axis.ticks=element_line(),
axis.title=element_text(size=16),
title=element_text(size=20),
legend.position = "none") +
labs(y="Richness",x=str_to_title("lab"),title= paste0("Ace Richness (p-value: ", toString(round(wilcox$p.value, 3)), ")"))
ace_plot
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
map_file <- read.table(url(mapper_url),comment.char = "", header=T, fill=T, sep="\t") %>% mutate(X.SampleID = gsub(pattern = "-",replacement = "-",x = X.SampleID))
ace_file <- read.table(paste('core-metrics-results-',file_path,'/ace_richness/alpha-diversity.tsv',sep=""), header=T, sep="\t") %>% mutate(X=as.character(X))
ace_table <- ace_file %>% left_join(map_file, by=c("X"="X.SampleID"))
alpha <- ace_table %>% group_by(lab) %>% summarise(X, richness = mean(ace)) %>% ungroup()
ace_table <- ace_table %>% left_join(alpha, "X" = "X")
ace_table <- dplyr::select(ace_table,X, lab, richness, ace)
wilcox <- wilcox.test(ace_table$ace~ace_table$lab)
ace_table <- ace_table %>% group_by(lab) %>% summarise(X, lab, richness, ace, SEM = (sd(ace) / sqrt(length(ace)))) %>% ungroup()
ace_table <- dplyr::select(ace_table, lab, richness, SEM) %>% unique()
ace_plot <- ggplot(ace_table, aes(x=lab, y=richness)) +
geom_bar(position=position_dodge(), stat="identity") +
geom_errorbar(aes(ymin=richness+SEM, ymax=richness-SEM),
width=.2, # Width of the error bars
position=position_dodge(.9)) +
coord_cartesian(ylim=c((min(ace_table$richness-ace_table$SEM)*.5),max(ace_table$richness+ace_table$SEM)*1.15)) +
theme_cowplot() +
theme(axis.text=element_text(size=14),
panel.background = element_blank(),
axis.line = element_line(),
axis.ticks=element_line(),
axis.title=element_text(size=16),
title=element_text(size=20),
legend.position = "none") +
labs(y="Richness",x=str_to_title("lab"),title= paste0("Ace Richness (p-value: ", toString(round(wilcox$p.value, 3)), ")"))
ace_plot
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
map_file <- read.table(url(mapper_url),comment.char = "", header=T, fill=T, sep="\t") %>% mutate(X.SampleID = gsub(pattern = "-",replacement = "-",x = X.SampleID))
ace_file <- read.table(url(paste(urlfile,'core-metrics-results-',file_path,'/ace_richness/alpha-diversity.tsv',sep="")), header=T, sep="\t") %>% mutate(X=as.character(X))
ace_table <- ace_file %>% left_join(map_file, by=c("X"="X.SampleID"))
alpha <- ace_table %>% group_by(lab) %>% summarise(X, richness = mean(ace)) %>% ungroup()
ace_table <- ace_table %>% left_join(alpha, "X" = "X")
ace_table <- dplyr::select(ace_table,X, lab, richness, ace)
wilcox <- wilcox.test(ace_table$ace~ace_table$lab)
ace_table <- ace_table %>% group_by(lab) %>% summarise(X, lab, richness, ace, SEM = (sd(ace) / sqrt(length(ace)))) %>% ungroup()
ace_table <- dplyr::select(ace_table, lab, richness, SEM) %>% unique()
ace_plot <- ggplot(ace_table, aes(x=lab, y=richness)) +
geom_bar(position=position_dodge(), stat="identity") +
geom_errorbar(aes(ymin=richness+SEM, ymax=richness-SEM),
width=.2, # Width of the error bars
position=position_dodge(.9)) +
coord_cartesian(ylim=c((min(ace_table$richness-ace_table$SEM)*.5),max(ace_table$richness+ace_table$SEM)*1.15)) +
theme_cowplot() +
theme(axis.text=element_text(size=14),
panel.background = element_blank(),
axis.line = element_line(),
axis.ticks=element_line(),
axis.title=element_text(size=16),
title=element_text(size=20),
legend.position = "none") +
labs(y="Richness",x=str_to_title("lab"),title= paste0("Ace Richness (p-value: ", toString(round(wilcox$p.value, 3)), ")"))
ace_plot
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
var1 = "genotype"
var2 = "sex"
taxonomic_level = "genus"
rpa_in_chart = 0.015
the_two_var = "twovar"
the_id = "X.SampleID"
plot_color = c("black","yellow","green1", "brown","blue","red")
plot_order = c("Pasteurellales", "Enterococcus" ,"Lactobacillaceae", "Lactobacillus", "Acetobacter")
x_val = "genotype"
read_depth = 1565
map_path = "-call19"
legend_position = "right"
plot_2016S <- make_taxon_plots_1var(file_path = file_path, urlpath = urlfile,	map_path = map_path, mapper_file = mapper_url, var1 = var1, taxonomic_level = taxonomic_level,	rpa_in_chart = rpa_in_chart,	the_two_var = "onevar",	the_id = "X.SampleID",	plot_color = plot_color,	plot_order = plot_order,	x_val = x_val,read_depth = read_depth, legend_position = legend_position)
flies.labs <- c("iPLA2-VIA (Control)", "iPLA2-VIA[Delta174] (Mutant)", "iPLA2-VIA[Delta192] (Mutant)")
names(flies.labs) <- c("iPLA2-VIA Control", "iPLA2-VIA[Delta174]", "iPLA2-VIA[Delta192]")
plot_2016S <- plot_2016S + facet_grid(.~get(var1), drop = TRUE, space = "free", scales = "free", labeller = labeller(.cols = flies.labs)) +
theme(
strip.text.x = element_text(
size = 8, color = "black"
)
)+
xlab("Fly Samples") +
ylab("Fractional Abundance") +
labs(fill = "Order Level Taxon")
plot_2016S
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
var1 = "genotype"
var2 = "sex"
taxonomic_level = "genus"
rpa_in_chart = 0.015
the_two_var = "twovar"
the_id = "X.SampleID"
plot_color = c("black","yellow", "brown","blue","red")
plot_order = c("Pasteurellales" ,"Lactobacillaceae", "Lactobacillus", "Acetobacter")
x_val = "genotype"
read_depth = 1565
map_path = "-call19"
legend_position = "right"
plot_2016S <- make_taxon_plots_1var(file_path = file_path, urlpath = urlfile,	map_path = map_path, mapper_file = mapper_url, var1 = var1, taxonomic_level = taxonomic_level,	rpa_in_chart = rpa_in_chart,	the_two_var = "onevar",	the_id = "X.SampleID",	plot_color = plot_color,	plot_order = plot_order,	x_val = x_val,read_depth = read_depth, legend_position = legend_position)
flies.labs <- c("iPLA2-VIA[Delta174] (Mutant)", "iPLA2-VIA[Delta192] (Mutant)")
names(flies.labs) <- c("iPLA2-VIA[Delta174]", "iPLA2-VIA[Delta192]")
plot_2016S <- plot_2016S + facet_grid(.~get(var1), drop = TRUE, space = "free", scales = "free", labeller = labeller(.cols = flies.labs)) +
theme(
strip.text.x = element_text(
size = 8, color = "black"
)
)+
xlab("Fly Samples") +
ylab("Fractional Abundance") +
labs(fill = "Order Level Taxon")
plot_2016S
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
folder_name = paste0(file_path, "/unweighted_unifrac")
var1 = "lab"
var1_colors <-c("blue","red")
title_name_add <- "unweighted Unifrac"
legend_position = "bottom"
labs = c("Bellen", "Bloomington")
plot_uw2016 <- pcoa_1var(urlpath = urlfile, folder_name=folder_name, mapper_file = mapper_url, var1=var1, var1_colors=var1_colors, title_name_add=title_name_add, legend_position = legend_position)
plot_uw2016 <- plot_uw2016 + scale_color_manual(name="Labs", labels=labs, values=var1_colors) +
scale_fill_manual(name="Labs", labels=labs, values=var1_colors)
plot_uw2016
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
folder_name = paste0(file_path, "/unweighted_unifrac")
var1 = "lab"
var1_colors <-c("blue","red")
title_name_add <- "unweighted Unifrac"
legend_position = "bottom"
labs = c("Bellen", "Bloomington")
plot_uw2016 <- pcoa_1var(urlpath = urlfile, folder_name=folder_name, mapper_file = mapper_url, var1=var1, var1_colors=var1_colors, title_name_add=title_name_add, legend_position = legend_position)
plot_uw2016 <- plot_uw2016 + scale_color_manual(name="Lab", labels=labs, values=var1_colors) +
scale_fill_manual(name="Lab", labels=labs, values=var1_colors)
plot_uw2016
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
folder_name = paste0(file_path, "/weighted_unifrac")
var1 = "lab"
var1_colors <-c("blue","red")
title_name_add <- "weighted Unifrac"
legend_position = "bottom"
labs = c("Bellen", "Bloomington")
plot_w2016 <- pcoa_1var(urlpath = urlfile, folder_name=folder_name, mapper_file = mapper_url, var1=var1, var1_colors=var1_colors, title_name_add=title_name_add, legend_position = legend_position)
plot_w2016 <- plot_w2016 + scale_color_manual(name="Lab", labels=labs, values=var1_colors) +
scale_fill_manual(name="Lab", labels=labs, values=var1_colors)
plot_w2016
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
folder_name = paste0(file_path, "/bray_curtis")
var1 = "lab"
var1_colors <-c("blue","red")
title_name_add <- "Bray Curtis"
legend_position = "bottom"
labs = c("Bellen", "Bloomington")
plot_bc2016 <- pcoa_1var(urlpath = urlfile,folder_name=folder_name, mapper_file = mapper_url, var1=var1, var1_colors=var1_colors,title_name_add=title_name_add, legend_position = legend_position)
plot_bc2016 <- plot_bc2016 + scale_color_manual(name="Lab", labels=labs, values=var1_colors) +
scale_fill_manual(name="Lab", labels=labs, values=var1_colors)
plot_bc2016
file_path <- "iPLA_noControl"
urlfile = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/No_Wol/iPLA_noControl/"
mapper_url = "https://raw.githubusercontent.com/emarsh25/chaston_lab/master/Park-Proj/Evan_stuff/CURA_project/call_mapper.tsv"
var1 = "lab"
var2 = "lab"
var3 = "lab"
the_id = "X.SampleID"
newcol <- "newcol"
main.var="lab"
adj.formula= "lab"
map_path = "-call19"
random.formula = NULL #"~1|vial_num"
multcorr="BH"
sig=0.05
prev.cut=0.9
Group = "lab"
taxonomic_level = "genus"
ancom_colors = c("yellow")
breaks = c("iPLA2-VIA[Delta174]", "iPLA2-VIA[Delta192]")
labs = c("iPLA2-VIA[Delta174] (Mutant)", "iPLA2-VIA[Delta192] (Mutant)")
make_ancom2_plots(urlpath = urlfile, file_path, map_path=map_path, mapper_file=url(mapper_url), taxonomic_level=taxonomic_level,var1=var1,var2=var2,var3=var3,newcol="newcol", the_id = "X.SampleID", main.var=main.var, adj.formula=adj.formula, random.formula = random.formula, repeat.var = repeat.var, multcorr=multcorr, sig=sig, prev.cut=prev.cut, Group = Group, color = ancom_colors, breaks = breaks, labs = labs)
library(parkFlies)
library(parkFlies)
devtools::install_github("johnchaston/df3")
devtools::install_github("emarsh25/chaston_lab")
learnr::run_tutorial("parkFlies", "Parkinson Flies")
devtools::install_github("emarsh25/chaston_lab")
devtools::install_github("emarsh25/chaston_lab")
